import{S as Z,G as ee,C as se,A as H,s as v}from"./GraduationYear-WyXObZjN.js";import{_ as oe,h as ne,k,l as d,m,s,q as t,y as te,D as y,E as g,B as le,C as i,v as _,A as f,r as b,I as K,J as I}from"./index-7S2n961R.js";import{C as re}from"./ClientEventService-ZeAPHePK.js";import{_ as ie}from"./confirmation-Mz0TInWP.js";const ae=ne({name:"event-scan",components:{School:Z,GraduationYear:ee,Country:se},props:{eventId:String},setup(o){const l=b(!0),D=b(),U=b(),T=b(),C=b(!1),p=b(!1),R=b(),n=b({role:"student",fullname:"",mail:"",phone:"",secondary_name:"",secondary_email:"",secondary_phone:"",school_id:"",other_school:"",graduation_year:"",destination_country:[],scholarship:"N",lead_source_id:"",event_id:"",attend_status:"",attend_party:"",event_type:"",status:"PR",referral:"",client_type:"",have_child:!1}),c=async e=>{if(e.length>10)K.push({name:"scan-event-vip",query:{url:e}});else{p.value=!0;const u=I().start();if(e){const a="v1/client-event/TKT/"+e;try{const h=await H.get(a);h.success?w(h.data):v("error","Please try again!","bottom-start"),p.value=!1,u.finish()}catch(h){p.value=!1,v("error","Please scan the correct QR Code","bottom-start"),console.error(h),u.finish()}}}},B=async()=>{const e=I().start(),u="v1/client-event/PH/"+D.value+"?EVT="+o.eventId;try{const a=await H.get(u);a.success?w(a.data):v("error","Please try again!","bottom-start"),D.value="",e.finish()}catch(a){v("error","Please input the correct phone number","bottom-start"),console.error(a),e.finish()}},q=(e=null)=>{n.value[e.key]=e==null?void 0:e.value},Y=e=>{n.value[e==null?void 0:e.key]=e==null?void 0:e.value},w=e=>{var u,a,h,N,x,z,P,E,S,V,j,r,O,$,L,M,Q,W,F,J;if(((u=e==null?void 0:e.joined_event)==null?void 0:u.attend_status)==1)v("warning","You have already scanned.","bottom-start");else{l.value=!1;const G=e.role;T.value=e.is_vip,U.value=(a=e.joined_event)==null?void 0:a.clientevent_id,n.value.role=e.role,n.value.fullname=(h=e[G])==null?void 0:h.name,n.value.mail=(N=e[G])==null?void 0:N.mail,n.value.phone=(x=e[G])==null?void 0:x.phone,n.value.secondary_name=e.role=="parent"?(z=e.student)==null?void 0:z.name:null,n.value.secondary_email=e.role=="parent"?(P=e.student)==null?void 0:P.mail:null,n.value.secondary_phone=e.role=="parent"?(E=e.student)==null?void 0:E.phone:null,n.value.school_id=(S=e.education)==null?void 0:S.school_id,n.value.other_school=null,n.value.graduation_year=(V=e.education)!=null&&V.graduation_year?(j=e.education)==null?void 0:j.graduation_year:null,n.value.destination_country=[],e!=null&&e.dreams_countries&&(e==null||e.dreams_countries.forEach(X=>{n.value.destination_country.push(X.country_id)})),n.value.scholarship=e!=null&&e.scholarship?e==null?void 0:e.scholarship:"N",n.value.lead_source_id=(r=e==null?void 0:e.lead)==null?void 0:r.lead_id,n.value.event_id=(O=e==null?void 0:e.joined_event)==null?void 0:O.event_id,n.value.attend_status=(($=e==null?void 0:e.joined_event)==null?void 0:$.attend_status)==1?"attend":null,n.value.attend_party=(L=e==null?void 0:e.joined_event)==null?void 0:L.attend_party,n.value.event_type=(M=e==null?void 0:e.joined_event)==null?void 0:M.event_type,n.value.status=((Q=e==null?void 0:e.joined_event)==null?void 0:Q.status)=="ots"?"OTS":"PR",n.value.referral=(W=e==null?void 0:e.joined_event)==null?void 0:W.referral,n.value.client_type=(F=e==null?void 0:e.joined_event)==null?void 0:F.client_type,n.value.have_child=!!(e.role=="parent"&&((J=e.student)!=null&&J.name))}};return{scan:l,event_id:U,is_vip:T,loading:C,qrloading:p,phone_number:D,error:R,registration:n,onDecode:c,checkPhone:B,checkComponent:q,newData:Y,checkingData:w,submit:async()=>{C.value=!0;const e=I().start(),u="v1/registration/verify/"+U.value;try{const a=await H.patch(u,n.value);a.success?(v("success",a.message,"bottom-start"),re.saveClientEvent(a),setTimeout(()=>{K.push({name:"thanks-event",params:{status:"ots",type:"onsite"}})},3e3)):(R.value=a.error?a.error:null,v("error",a.message?a.message:"Please complete the fields above!","bottom-start")),C.value=!1,e.finish()}catch(a){v("error","Please try again!","bottom-start"),C.value=!1,console.error(a),e.finish()}}}}}),ce={id:"registration"},de={class:"container-fluid"},me={key:0,class:"row",style:{height:"100dvh"}},ue=s("div",{class:"col-md-8 bg-primary",style:{background:"url('/img/bg-scan.webp')","background-size":"cover","background-position":"center"}},null,-1),_e={class:"col-md-4"},he={class:"d-flex align-items-center w-100 h-100 px-5"},pe={class:"d-flex align-items-center w-100 h-100"},ve={class:"w-100 text-center"},ye={class:"btn btn-sm btn-outline-primary mb-4"},ge=s("div",{class:"p-2 text-white",style:{background:"#0100d4"}},[s("h3",{class:"m-0",style:{"text-shadow":"2px 2px #3a3939"}},[s("strong",null,[i(" SCAN YOUR "),s("br"),i(" QR-CODE HERE ")])])],-1),fe={class:"card shadow rounded-0 border-0 mb-3"},be={class:"card-body p-1"},ke={key:0,class:"p-0"},we={key:1,class:"p-2"},Ce=s("h4",null,"OR",-1),Ne=s("div",{class:"p-2",style:{background:"#fed118"}},[s("h5",{class:"m-0 text-dark",style:{"text-shadow":"1px 1px #fff"}},[s("strong",null," WITH PHONE NUMBER ")])],-1),xe={class:"card shadow rounded-0 border-0"},ze={class:"card-body p-1"},Pe={class:"input-group"},Ee={class:"input-group-text",id:"number"},Se={key:1,class:"row justify-content-center",style:{height:"100dvh"}},Ve={class:"col-md-8"},je={class:"d-flex align-items-center w-100 h-100"},De={class:"card shadow border-0 rounded-0 w-100"},Ue={class:"d-flex justify-content-between align-items-center my-0"},Re={class:"m-0 d-flex"},Te={class:"d-flex align-items-center"},Be={key:0,class:"mb-0"},qe={class:"card-body"},Ye={class:"row align-items-center"},Ae=s("div",{class:"col-md-4 text-center"},[s("img",{src:ie,alt:"EduALL Confirmation",class:"w-75"})],-1),Ge={class:"col-md-8"},He={class:"row g-3"},Ie={class:"col-md-6"},Oe={class:"text-muted label"},$e=s("span",{class:"text-danger"},"*",-1),Le={key:0,class:"text-danger error"},Me={class:"col-md-6"},Qe={class:"text-muted label"},We=s("span",{class:"text-danger"},"*",-1),Fe={key:0,class:"text-danger error"},Je={class:"col-md-6"},Ke={class:"text-muted label"},Xe=s("span",{class:"text-danger"},"*",-1),Ze={key:0,class:"text-danger error"},es={key:0,class:"col-md-6"},ss={class:"text-muted label"},os=s("span",{class:"text-danger"},"*",-1),ns={key:0,class:"text-danger error"},ts={key:1,class:"col-md-12"},ls={class:"row"},rs={class:"col-md-4"},is={class:"text-muted label"},as=s("span",{class:"text-danger"},"*",-1),cs={key:0,class:"text-danger error"},ds={class:"col-md-4"},ms={class:"text-muted label"},us=s("span",{class:"text-danger"},null,-1),_s={class:"col-md-4"},hs={class:"text-muted label"},ps=s("span",{class:"text-danger"},null,-1),vs={key:2,class:"col-md-12"},ys={class:"text-muted label"},gs=s("span",{class:"text-danger"},"*",-1),fs={key:0,class:"text-danger error"},bs={key:3,class:"col-md-12"},ks={class:"text-muted label"},ws=s("span",{class:"text-danger"},"*",-1),Cs={key:0,class:"text-danger error"},Ns=s("hr",null,null,-1),xs={class:"d-flex justify-content-between align-items-end mb-3"},zs=["disabled"],Ps={class:"d-flex w-75 text-end align-items-end justify-content-end"},Es={style:{width:"100px"}},Ss=s("small",{class:"text-muted label"},[i(" Party Number "),s("span",{class:"text-danger"},"*")],-1),Vs=["disabled"];function js(o,l,D,U,T,C){var w,A,e,u,a,h,N,x,z,P,E,S,V,j;const p=k("font-awesome-icon"),R=k("router-link"),n=k("qr-stream"),c=k("box-icon"),B=k("GraduationYear"),q=k("School"),Y=k("Country");return d(),m("div",ce,[s("div",de,[o.scan?(d(),m("div",me,[ue,s("div",_e,[s("div",he,[s("div",pe,[s("div",ve,[t(R,{to:{name:"home"}},{default:te(()=>[s("div",ye,[t(p,{icon:"fa-home",class:"me-2"}),i(" Back to Home ")])]),_:1}),ge,s("div",fe,[s("div",be,[o.qrloading?(d(),m("div",we,[t(c,{name:"loader-circle",animation:"spin"})])):(d(),m("div",ke,[t(n,{onDecode:o.onDecode,style:{width:"100%"},class:"rounded"},null,8,["onDecode"])]))])]),Ce,Ne,s("div",xe,[s("div",ze,[s("div",Pe,[s("span",Ee,[t(c,{name:"phone",size:"15px",animation:"tada",class:"pb-2"})]),y(s("input",{type:"text",class:"form-control form-control-sm","aria-describedby":"number","onUpdate:modelValue":l[0]||(l[0]=r=>o.phone_number=r),onChange:l[1]||(l[1]=(...r)=>o.checkPhone&&o.checkPhone(...r))},null,544),[[g,o.phone_number]])])])])])])])])])):(d(),m("div",Se,[s("div",Ve,[s("div",je,[s("div",De,[s("div",{class:le(["card-header",o.is_vip?"bg-warning text-white":""])},[s("div",Ue,[s("h4",Re,[t(c,{name:"user-circle",color:o.is_vip?"#fff":"#000",class:"mt-1 me-2"},null,8,["color"]),i(" Confirmation ")]),s("div",Te,[o.is_vip?(d(),m("h2",Be,"VIP")):_("",!0)])])],2),s("div",qe,[s("div",Ye,[Ae,s("div",Ge,[s("div",He,[s("div",Ie,[s("small",Oe,[t(c,{name:"user",size:"12px",className:"me-2",color:"#969696"}),i(" Full Name "),$e]),y(s("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=r=>o.registration.fullname=r),class:"form-control"},null,512),[[g,o.registration.fullname]]),(w=o.error)!=null&&w.fullname?(d(),m("small",Le,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((A=o.error)==null?void 0:A.fullname[0]),1)])):_("",!0)]),s("div",Me,[s("small",Qe,[t(c,{name:"envelope",size:"12px",className:"me-2",color:"#969696"}),i(" Email "),We]),y(s("input",{type:"email","onUpdate:modelValue":l[3]||(l[3]=r=>o.registration.mail=r),class:"form-control"},null,512),[[g,o.registration.mail]]),(e=o.error)!=null&&e.mail?(d(),m("small",Fe,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((u=o.error)==null?void 0:u.mail[0]),1)])):_("",!0)]),s("div",Je,[s("small",Ke,[t(c,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),i(" Phone Number "),Xe]),y(s("input",{type:"text","onUpdate:modelValue":l[4]||(l[4]=r=>o.registration.phone=r),class:"form-control"},null,512),[[g,o.registration.phone]]),(a=o.error)!=null&&a.phone?(d(),m("small",Ze,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((h=o.error)==null?void 0:h.phone[0]),1)])):_("",!0)]),o.registration.graduation_year?(d(),m("div",es,[s("small",ss,[t(c,{name:"graduation",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Graduation Year "),os]),t(B,{data:o.registration.graduation_year,onCheck:o.checkComponent},null,8,["data","onCheck"]),(N=o.error)!=null&&N.graduation_year?(d(),m("small",ns,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((x=o.error)==null?void 0:x.graduation_year[0]),1)])):_("",!0)])):_("",!0),o.registration.have_child?(d(),m("div",ts,[s("div",ls,[s("div",rs,[s("small",is,[t(c,{name:"user",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Child Name "),as]),y(s("input",{type:"text","onUpdate:modelValue":l[5]||(l[5]=r=>o.registration.secondary_name=r),class:"form-control"},null,512),[[g,o.registration.secondary_name]]),(z=o.error)!=null&&z.secondary_name?(d(),m("small",cs,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((P=o.error)==null?void 0:P.secondary_name[0]),1)])):_("",!0)]),s("div",ds,[s("small",ms,[t(c,{name:"envelope",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Child Email "),us]),y(s("input",{type:"email","onUpdate:modelValue":l[6]||(l[6]=r=>o.registration.secondary_email=r),class:"form-control"},null,512),[[g,o.registration.secondary_email]])]),s("div",_s,[s("small",hs,[t(c,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),i(" Child Number "),ps]),y(s("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=r=>o.registration.secondary_phone=r),class:"form-control"},null,512),[[g,o.registration.secondary_phone]])])])])):_("",!0),o.registration.role=="parent"&&o.registration.have_child||o.registration.role=="student"||o.registration.role=="teacher/counsellor"?(d(),m("div",vs,[s("small",ys,[t(c,{name:"school",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" School Name "),gs]),t(q,{data:o.registration.school_id,onCheck:o.checkComponent,onNew:o.newData},null,8,["data","onCheck","onNew"]),(E=o.error)!=null&&E.school_id?(d(),m("small",fs,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((S=o.error)==null?void 0:S.school_id[0]),1)])):_("",!0)])):_("",!0),o.registration.role=="parent"&&o.registration.have_child||o.registration.role=="student"?(d(),m("div",bs,[s("small",ks,[t(c,{name:"flag-alt",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Dream University "),ws]),t(Y,{data:o.registration.destination_country,onCheck:o.checkComponent},null,8,["data","onCheck"]),(V=o.error)!=null&&V.destination_country?(d(),m("small",Cs,[t(c,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+f((j=o.error)==null?void 0:j.destination_country[0]),1)])):_("",!0)])):_("",!0)])])]),Ns,s("div",xs,[s("button",{class:"btn btn-outline-warning py-1 px-2",onClick:l[8]||(l[8]=r=>o.scan=!0),disabled:o.loading},[t(p,{icon:"fa-arrow-left"}),i(" Back to Scan ")],8,zs),s("div",Ps,[s("div",Es,[Ss,y(s("input",{type:"number","onUpdate:modelValue":l[9]||(l[9]=r=>o.registration.attend_party=r),class:"form-control mb-0",style:{"font-weight":"bold"}},null,512),[[g,o.registration.attend_party]])]),s("button",{class:"btn btn-primary ms-2 h-100",onClick:l[10]||(l[10]=(...r)=>o.submit&&o.submit(...r)),disabled:o.loading},[t(p,{icon:o.loading?"fa-solid fa-spinner":"fa-solid fa-save",class:"me-2",pulse:o.loading},null,8,["icon","pulse"]),i(" "+f(o.loading?"Waiting":"Submit"),1)],8,Vs)])])])])])])]))])])}const Bs=oe(ae,[["render",js]]);export{Bs as default};
