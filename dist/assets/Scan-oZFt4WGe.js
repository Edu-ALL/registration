import{S as W,G as F,C as J,A as N}from"./GraduationYear-MmG6WWAE.js";import{_ as K,h as Q,k as _,l as h,m as p,s as e,q as i,y as X,D as d,E as m,B as Z,C as r,v as g,A as ee,r as v,J as x,I as se}from"./index-AdnWvsUp.js";import{s as E}from"./notification-mjY-tVwt.js";import{C as oe}from"./ClientEventService-ZeAPHePK.js";import{_ as ne}from"./confirmation-f4m2PyRg.js";const te=Q({name:"event-scan",components:{School:W,GraduationYear:F,Country:J},props:{eventId:String},setup(o){const l=v(!0),f=v(),y=v(),b=v(),S=v(!1),t=v({role:"student",fullname:"",mail:"",phone:"",secondary_name:"",secondary_email:"",secondary_phone:"",school_id:"",other_school:"",graduation_year:"",destination_country:[],scholarship:"N",lead_source_id:"",event_id:"",attend_status:"",attend_party:"",event_type:"",status:"PR",referral:"",client_type:"",have_child:!1}),w=async s=>{const c=x().start();if(s){const n="v1/client-event/TKT/"+s;try{const u=await N.get(n);u.success&&a(u.data),c.finish()}catch(u){console.error(u),c.finish()}}},C=async()=>{const s=x().start(),c="v1/client-event/PH/"+f.value+"?EVT="+o.eventId;try{const n=await N.get(c);n.success&&a(n.data),s.finish()}catch(n){console.error(n),s.finish()}},a=s=>{var c,n,u,j,P,z,D,U,T,B,R,Y,A,G,H,I,O,$,q,L;if(((c=s==null?void 0:s.joined_event)==null?void 0:c.attend_status)==1)E("warning","You have already scanned.","bottom-start");else{l.value=!1;const k=s.role=="teacher/counsellor"?"teacher":s.role;b.value=s.is_vip,y.value=(n=s.joined_event)==null?void 0:n.clientevent_id,t.value.role=s.role,t.value.fullname=(u=s[k])==null?void 0:u.name,t.value.mail=(j=s[k])==null?void 0:j.mail,t.value.phone=(P=s[k])==null?void 0:P.phone,t.value.secondary_name=s.role=="parent"?(z=s.student)==null?void 0:z.name:null,t.value.secondary_email=s.role=="parent"?(D=s.student)==null?void 0:D.mail:null,t.value.secondary_phone=s.role=="parent"?(U=s.student)==null?void 0:U.phone:null,t.value.school_id=(T=s.education)==null?void 0:T.school_id,t.value.other_school=null,t.value.graduation_year=(B=s.education)!=null&&B.graduation_year?(R=s.education)==null?void 0:R.graduation_year:null,t.value.destination_country=[],s!=null&&s.dreams_countries&&(s==null||s.dreams_countries.forEach(M=>{t.value.destination_country.push(M.country_id)})),t.value.scholarship=s!=null&&s.scholarship?s==null?void 0:s.scholarship:"N",t.value.lead_source_id=(Y=s==null?void 0:s.lead)==null?void 0:Y.lead_id,t.value.event_id=(A=s==null?void 0:s.joined_event)==null?void 0:A.event_id,t.value.attend_status=((G=s==null?void 0:s.joined_event)==null?void 0:G.attend_status)==1?"attend":null,t.value.attend_party=(H=s==null?void 0:s.joined_event)==null?void 0:H.attend_party,t.value.event_type=(I=s==null?void 0:s.joined_event)==null?void 0:I.event_type,t.value.status=((O=s==null?void 0:s.joined_event)==null?void 0:O.status)=="ots"?"OTS":"PR",t.value.referral=($=s==null?void 0:s.joined_event)==null?void 0:$.referral,t.value.client_type=(q=s==null?void 0:s.joined_event)==null?void 0:q.client_type,t.value.have_child=!!(s.role=="parent"&&((L=s.student)!=null&&L.name))}};return{scan:l,event_id:y,is_vip:b,loading:S,phone_number:f,registration:t,onDecode:w,checkPhone:C,checkingData:a,submit:async()=>{const s=x().start(),c="v1/registration/verify/"+y.value;try{const n=await N.patch(c,t.value);n.success?(E("success",n.message,"bottom-start"),oe.saveClientEvent(n),setTimeout(()=>{se.push({name:"thanks-event",params:{status:"ots",type:"onsite"}})},3e3)):E("error","Please try again!","bottom-start"),s.finish()}catch(n){console.error(n),s.finish()}}}}}),le={id:"registration"},ie={class:"container-fluid"},re={key:0,class:"row",style:{height:"100dvh"}},ae=e("div",{class:"col-md-8 bg-primary"},[e("div",{class:"d-flex align-items-center w-100 h-100 px-5"},[e("h2",null,"Event Name")])],-1),ce={class:"col-md-4"},de={class:"d-flex align-items-center w-100 h-100 px-5"},me={class:"d-flex align-items-center w-100 h-100"},ue={class:"w-100 text-center"},_e={class:"btn btn-sm btn-outline-primary mb-4"},he=e("h3",null,[e("strong",null,[r(" SCAN YOUR "),e("br"),r(" QR-CODE HERE ")])],-1),pe={class:"card shadow-sm rounded-0 border-0 mb-3"},ve={class:"card-body"},ye={class:"p-2"},ge=e("h4",null,"OR",-1),fe=e("h5",null,"WITH PHONE NUMBER",-1),be={class:"card shadow-sm rounded-0 border-0"},we={class:"card-body"},Ce={class:"input-group mb-3"},ke={class:"input-group-text",id:"number"},Ne={key:1,class:"row justify-content-center",style:{height:"100dvh"}},xe={class:"col-md-8"},Ee={class:"d-flex align-items-center w-100 h-100"},Se={class:"card shadow border-0 rounded-0 w-100"},Ve={class:"d-flex justify-content-between align-items-center my-0"},je={class:"m-0 d-flex"},Pe={class:"d-flex align-items-center"},ze={key:0,class:"mb-0"},De={class:"card-body"},Ue={class:"row align-items-center"},Te=e("div",{class:"col-md-4 text-center"},[e("img",{src:ne,alt:"EduALL Confirmation",class:"w-75"})],-1),Be={class:"col-md-8"},Re={class:"row g-3"},Ye={class:"col-md-6"},Ae={class:"text-muted label"},Ge=e("span",{class:"text-danger"},"*",-1),He={class:"col-md-6"},Ie={class:"text-muted label"},Oe=e("span",{class:"text-danger"},"*",-1),$e={class:"col-md-6"},qe={class:"text-muted label"},Le=e("span",{class:"text-danger"},"*",-1),Me={key:0,class:"col-md-6"},We={class:"text-muted label"},Fe=e("span",{class:"text-danger"},"*",-1),Je={key:1,class:"col-md-12"},Ke={class:"row"},Qe={class:"col-md-4"},Xe={class:"text-muted label"},Ze=e("span",{class:"text-danger"},"*",-1),es={class:"col-md-4"},ss={class:"text-muted label"},os=e("span",{class:"text-danger"},null,-1),ns={class:"col-md-4"},ts={class:"text-muted label"},ls=e("span",{class:"text-danger"},null,-1),is={class:"col-md-12"},rs={class:"text-muted label"},as=e("span",{class:"text-danger"},"*",-1),cs={key:2,class:"col-md-12"},ds={class:"text-muted label"},ms=e("span",{class:"text-danger"},"*",-1),us=e("hr",null,null,-1),_s={class:"d-flex justify-content-between align-items-end mb-3"},hs={class:"d-flex w-75 text-end align-items-end justify-content-end"},ps={style:{width:"100px"}},vs=e("small",{class:"text-muted label"},[r(" Party Number "),e("span",{class:"text-danger"},"*")],-1);function ys(o,l,f,y,b,S){const t=_("font-awesome-icon"),w=_("router-link"),C=_("qr-stream"),a=_("box-icon"),V=_("GraduationYear"),s=_("School"),c=_("Country");return h(),p("div",le,[e("div",ie,[o.scan?(h(),p("div",re,[ae,e("div",ce,[e("div",de,[e("div",me,[e("div",ue,[i(w,{to:{name:"home"}},{default:X(()=>[e("div",_e,[i(t,{icon:"fa-home",class:"me-2"}),r(" Back to Home ")])]),_:1}),he,e("div",pe,[e("div",ve,[e("div",ye,[i(C,{onDecode:o.onDecode,style:{width:"100%"},class:"rounded"},null,8,["onDecode"])])])]),ge,fe,e("div",be,[e("div",we,[e("div",Ce,[e("span",ke,[i(a,{name:"phone",size:"15px",animation:"tada",class:"pb-2"})]),d(e("input",{type:"text",class:"form-control form-control-sm","aria-describedby":"number","onUpdate:modelValue":l[0]||(l[0]=n=>o.phone_number=n),onChange:l[1]||(l[1]=(...n)=>o.checkPhone&&o.checkPhone(...n))},null,544),[[m,o.phone_number]])])])])])])])])])):(h(),p("div",Ne,[e("div",xe,[e("div",Ee,[e("div",Se,[e("div",{class:Z(["card-header",o.is_vip?"bg-warning text-white":""])},[e("div",Ve,[e("h4",je,[i(a,{name:"user-circle",color:o.is_vip?"#fff":"#000",class:"mt-1 me-2"},null,8,["color"]),r(" Confirmation ")]),e("div",Pe,[o.is_vip?(h(),p("h2",ze,"VIP")):g("",!0)])])],2),e("div",De,[e("div",Ue,[Te,e("div",Be,[e("div",Re,[e("div",Ye,[e("small",Ae,[i(a,{name:"user",size:"12px",className:"me-2",color:"#969696"}),r(" Full Name "),Ge]),d(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=n=>o.registration.fullname=n),class:"form-control"},null,512),[[m,o.registration.fullname]])]),e("div",He,[e("small",Ie,[i(a,{name:"envelope",size:"12px",className:"me-2",color:"#969696"}),r(" Email "),Oe]),d(e("input",{type:"email","onUpdate:modelValue":l[3]||(l[3]=n=>o.registration.mail=n),class:"form-control"},null,512),[[m,o.registration.mail]])]),e("div",$e,[e("small",qe,[i(a,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),r(" Phone Number "),Le]),d(e("input",{type:"text","onUpdate:modelValue":l[4]||(l[4]=n=>o.registration.phone=n),class:"form-control"},null,512),[[m,o.registration.phone]])]),o.registration.graduation_year?(h(),p("div",Me,[e("small",We,[i(a,{name:"graduation",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Graduation Year "),Fe]),i(V,{data:o.registration.graduation_year,onCheck:o.checkComponent},null,8,["data","onCheck"])])):g("",!0),o.registration.have_child?(h(),p("div",Je,[e("div",Ke,[e("div",Qe,[e("small",Xe,[i(a,{name:"user",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Child Name "),Ze]),d(e("input",{type:"text","onUpdate:modelValue":l[5]||(l[5]=n=>o.registration.secondary_name=n),class:"form-control"},null,512),[[m,o.registration.secondary_name]])]),e("div",es,[e("small",ss,[i(a,{name:"envelope",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Child Email "),os]),d(e("input",{type:"email","onUpdate:modelValue":l[6]||(l[6]=n=>o.registration.secondary_email=n),class:"form-control"},null,512),[[m,o.registration.secondary_email]])]),e("div",ns,[e("small",ts,[i(a,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),r(" Child Number "),ls]),d(e("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=n=>o.registration.secondary_phone=n),class:"form-control"},null,512),[[m,o.registration.secondary_phone]])])])])):g("",!0),e("div",is,[e("small",rs,[i(a,{name:"school",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" School Name "),as]),i(s,{data:o.registration.school_id,onCheck:o.checkComponent,onNew:o.newData},null,8,["data","onCheck","onNew"])]),o.registration.role=="parent"&&o.registration.have_child||o.registration.role=="student"?(h(),p("div",cs,[e("small",ds,[i(a,{name:"flag-alt",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Dream University "),ms]),i(c,{data:o.registration.destination_country,onCheck:o.checkComponent},null,8,["data","onCheck"])])):g("",!0)])])]),us,e("div",_s,[e("div",{class:"btn btn-outline-warning py-1 px-2",onClick:l[8]||(l[8]=n=>o.scan=!0)},[i(t,{icon:"fa-arrow-left"}),r(" Back to Scan ")]),e("div",hs,[e("div",ps,[vs,d(e("input",{type:"number","onUpdate:modelValue":l[9]||(l[9]=n=>o.registration.attend_party=n),class:"form-control mb-0",style:{"font-weight":"bold"}},null,512),[[m,o.registration.attend_party]])]),e("button",{class:"btn btn-primary ms-2 h-100",onClick:l[10]||(l[10]=(...n)=>o.submit&&o.submit(...n))},[i(t,{icon:o.loading?"fa-solid fa-spinner":"fa-solid fa-save",class:"me-2",pulse:o.loading},null,8,["icon","pulse"]),r(" "+ee(o.loading?"Waiting":"Submit"),1)])])])])])])])]))])])}const ks=K(te,[["render",ys]]);export{ks as default};
