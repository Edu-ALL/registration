import{S as W,G as K,C as X,A as Y,s as b}from"./GraduationYear-MlyzemBX.js";import{_ as Z,h as ee,k,l as c,m as d,s,q as t,B as se,C as l,v as _,D as v,E as y,A as p,r as g,j as oe,J as $,I as ne}from"./index-YyGvbazE.js";import{C as te}from"./ClientEventService-ZeAPHePK.js";import{_ as le}from"./confirmation-f4m2PyRg.js";const re=ee({name:"event-scan",props:{url:String},components:{School:W,GraduationYear:K,Country:X},setup(o){const r=g(!0),E=g(),q=g(),w=g(!1),h=g(!1),P=g(),n=g({role:"student",fullname:"",mail:"",phone:"",secondary_name:"",secondary_email:"",secondary_phone:"",school_id:"",other_school:"",graduation_year:"",destination_country:[],scholarship:"N",lead_source_id:"",event_id:"",attend_status:"",attend_party:"",event_type:"",status:"PR",referral:"",client_type:"",have_child:!1}),A=async e=>{console.log(e);const u=$().start();if(h.value=!0,e){const i=e;try{const m=await Y.get(i);m.success?f(m.data):b("error","Please try again!","bottom-start"),h.value=!1,u.finish()}catch(m){console.error(m),h.value=!1,u.finish()}}},B=async e=>{const u=$().start();h.value=!0;const i=e;console.log(i);try{const m=await Y.get(i);m.success?f(m.data):b("error","Please try again!","bottom-start"),h.value=!1,u.finish()}catch(m){b("error","Please try again!","bottom-start"),console.error(m),h.value=!1,u.finish()}},G=(e=null)=>{n.value[e.key]=e==null?void 0:e.value,console.log(n.value)},U=e=>{n.value[e==null?void 0:e.key]=e==null?void 0:e.value},f=e=>{var i,m,N,C,x,z,S,j,V,D,a,T,I,L,O,M,F,H,J;r.value=!1;const u=e.role=="teacher/counsellor"?"teacher":e.role;q.value=e.is_vip,E.value=(i=e.joined_event)==null?void 0:i.clientevent_id,n.value.role=e.role,n.value.fullname=(m=e[u])==null?void 0:m.name,n.value.mail=(N=e[u])==null?void 0:N.mail,n.value.phone=(C=e[u])==null?void 0:C.phone,n.value.secondary_name=e.role=="parent"?(x=e.student)==null?void 0:x.name:null,n.value.secondary_email=e.role=="parent"?(z=e.student)==null?void 0:z.mail:null,n.value.secondary_phone=e.role=="parent"?(S=e.student)==null?void 0:S.phone:null,n.value.school_id=(j=e.education)==null?void 0:j.school_id,n.value.other_school=null,n.value.graduation_year=(V=e.education)!=null&&V.graduation_year?(D=e.education)==null?void 0:D.graduation_year:null,n.value.destination_country=[],e!=null&&e.dreams_countries&&(e==null||e.dreams_countries.forEach(Q=>{n.value.destination_country.push(Q.country_id)})),n.value.scholarship=e!=null&&e.scholarship?e==null?void 0:e.scholarship:"N",n.value.lead_source_id=(a=e==null?void 0:e.lead)==null?void 0:a.lead_id,n.value.event_id=(T=e==null?void 0:e.joined_event)==null?void 0:T.event_id,n.value.attend_status=((I=e==null?void 0:e.joined_event)==null?void 0:I.attend_status)==1?"attend":null,n.value.attend_party=(L=e==null?void 0:e.joined_event)==null?void 0:L.attend_party,n.value.event_type=(O=e==null?void 0:e.joined_event)==null?void 0:O.event_type,n.value.status=((M=e==null?void 0:e.joined_event)==null?void 0:M.status)=="ots"?"OTS":"PR",n.value.referral=(F=e==null?void 0:e.joined_event)==null?void 0:F.referral,n.value.client_type=(H=e==null?void 0:e.joined_event)==null?void 0:H.client_type,n.value.have_child=!!(e.role=="parent"&&((J=e.student)!=null&&J.name))},R=async()=>{w.value=!0;const e=$().start(),u="v1/registration/verify/"+E.value;try{const i=await Y.patch(u,n.value);i.success?(b("success",i.message,"bottom-start"),te.saveClientEvent(i),setTimeout(()=>{ne.push({name:"thanks-event",params:{status:"ots",type:"onsite"}})},3e3)):(P.value=i.error?i.error:null,b("error",i.message?i.message:"Please complete the fields above!","bottom-start")),w.value=!1,e.finish()}catch(i){b("error","Please try again!","bottom-start"),w.value=!1,console.error(i),e.finish()}};return oe(()=>{o.url&&B(o.url)}),{scan:r,event_id:E,is_vip:q,loading:w,qrloading:h,error:P,registration:n,onDecode:A,checkComponent:G,newData:U,checkingData:f,submit:R}}}),ie={id:"registration"},ae={class:"container-fluid"},ce={key:0,class:"row",style:{height:"100dvh"}},de=s("div",{class:"col-md-8 bg-primary"},[s("div",{class:"d-flex align-items-center w-100 h-100 px-5"},[s("h2",null,"Event Name")])],-1),me={class:"col-md-4"},ue={class:"d-flex align-items-center w-100 h-100 px-5"},_e={class:"d-flex align-items-center w-100 h-100"},he={class:"w-100 text-center"},pe=s("h3",null,[s("strong",null,[l(" SCAN YOUR "),s("br"),l(" QR-CODE HERE ")])],-1),ve={class:"card shadow-sm rounded-0 border-0 mb-3"},ye={class:"card-body"},ge={key:0,class:"p-2"},fe={key:1,class:"p-2"},be={key:1,class:"row justify-content-center",style:{height:"100dvh"}},ke={class:"col-md-8"},we={class:"d-flex align-items-center w-100 h-100"},Ne={class:"card shadow border-0 rounded-0 w-100"},Ce={class:"d-flex justify-content-between align-items-center my-0"},xe={class:"m-0 d-flex"},ze={class:"d-flex align-items-center"},Se={key:0,class:"mb-0"},je={class:"card-body"},Ve={class:"row align-items-center"},De=s("div",{class:"col-md-4 text-center"},[s("img",{src:le,alt:"EduALL Confirmation",class:"w-75"})],-1),Ee={class:"col-md-8"},Pe={class:"row g-3"},Ue={class:"col-md-6"},Re={class:"text-muted label"},qe=s("span",{class:"text-danger"},"*",-1),Ae={key:0,class:"text-danger error"},Be={class:"col-md-6"},Ge={class:"text-muted label"},Ye=s("span",{class:"text-danger"},"*",-1),$e={key:0,class:"text-danger error"},Te={class:"col-md-6"},Ie={class:"text-muted label"},Le=s("span",{class:"text-danger"},"*",-1),Oe={key:0,class:"text-danger error"},Me={key:0,class:"col-md-6"},Fe={class:"text-muted label"},He=s("span",{class:"text-danger"},"*",-1),Je={key:0,class:"text-danger error"},Qe={key:1,class:"col-md-12"},We={class:"row"},Ke={class:"col-md-4"},Xe={class:"text-muted label"},Ze=s("span",{class:"text-danger"},"*",-1),es={key:0,class:"text-danger error"},ss={class:"col-md-4"},os={class:"text-muted label"},ns=s("span",{class:"text-danger"},null,-1),ts={class:"col-md-4"},ls={class:"text-muted label"},rs=s("span",{class:"text-danger"},null,-1),is={class:"col-md-12"},as={class:"text-muted label"},cs=s("span",{class:"text-danger"},"*",-1),ds={key:0,class:"text-danger error"},ms={key:2,class:"col-md-12"},us={class:"text-muted label"},_s=s("span",{class:"text-danger"},"*",-1),hs={key:0,class:"text-danger error"},ps=s("hr",null,null,-1),vs={class:"d-flex justify-content-between align-items-end mb-3"},ys=["disabled"],gs={class:"d-flex w-75 text-end align-items-end justify-content-end"},fs={style:{width:"100px"}},bs=s("small",{class:"text-muted label"},[l(" Party Number "),s("span",{class:"text-danger"},"*")],-1),ks=["disabled"];function ws(o,r,E,q,w,h){var f,R,e,u,i,m,N,C,x,z,S,j,V,D;const P=k("qr-stream"),n=k("box-icon"),A=k("GraduationYear"),B=k("School"),G=k("Country"),U=k("font-awesome-icon");return c(),d("div",ie,[s("div",ae,[o.scan?(c(),d("div",ce,[de,s("div",me,[s("div",ue,[s("div",_e,[s("div",he,[pe,s("div",ve,[s("div",ye,[o.qrloading?(c(),d("div",fe,[t(n,{name:"loader-circle",animation:"spin"})])):(c(),d("div",ge,[t(P,{onDecode:o.onDecode,style:{width:"100%"},class:"rounded"},null,8,["onDecode"])]))])])])])])])])):(c(),d("div",be,[s("div",ke,[s("div",we,[s("div",Ne,[s("div",{class:se(["card-header",o.is_vip?"bg-warning text-white":""])},[s("div",Ce,[s("h4",xe,[t(n,{name:"user-circle",color:o.is_vip?"#fff":"#000",class:"mt-1 me-2"},null,8,["color"]),l(" Confirmation ")]),s("div",ze,[o.is_vip?(c(),d("h2",Se,"VIP")):_("",!0)])])],2),s("div",je,[s("div",Ve,[De,s("div",Ee,[s("div",Pe,[s("div",Ue,[s("small",Re,[t(n,{name:"user",size:"12px",className:"me-2",color:"#969696"}),l(" Full Name "),qe]),v(s("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=a=>o.registration.fullname=a),class:"form-control"},null,512),[[y,o.registration.fullname]]),(f=o.error)!=null&&f.fullname?(c(),d("small",Ae,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((R=o.error)==null?void 0:R.fullname[0]),1)])):_("",!0)]),s("div",Be,[s("small",Ge,[t(n,{name:"envelope",size:"12px",className:"me-2",color:"#969696"}),l(" Email "),Ye]),v(s("input",{type:"email","onUpdate:modelValue":r[1]||(r[1]=a=>o.registration.mail=a),class:"form-control"},null,512),[[y,o.registration.mail]]),(e=o.error)!=null&&e.mail?(c(),d("small",$e,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((u=o.error)==null?void 0:u.mail[0]),1)])):_("",!0)]),s("div",Te,[s("small",Ie,[t(n,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),l(" Phone Number "),Le]),v(s("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=a=>o.registration.phone=a),class:"form-control"},null,512),[[y,o.registration.phone]]),(i=o.error)!=null&&i.phone?(c(),d("small",Oe,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((m=o.error)==null?void 0:m.phone[0]),1)])):_("",!0)]),o.registration.graduation_year?(c(),d("div",Me,[s("small",Fe,[t(n,{name:"graduation",type:"solid",size:"12px",className:"me-2",color:"#969696"}),l(" Graduation Year "),He]),t(A,{data:o.registration.graduation_year,onCheck:o.checkComponent},null,8,["data","onCheck"]),(N=o.error)!=null&&N.graduation_year?(c(),d("small",Je,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((C=o.error)==null?void 0:C.graduation_year[0]),1)])):_("",!0)])):_("",!0),o.registration.have_child?(c(),d("div",Qe,[s("div",We,[s("div",Ke,[s("small",Xe,[t(n,{name:"user",type:"solid",size:"12px",className:"me-2",color:"#969696"}),l(" Child Name "),Ze]),v(s("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=a=>o.registration.secondary_name=a),class:"form-control"},null,512),[[y,o.registration.secondary_name]]),(x=o.error)!=null&&x.secondary_name?(c(),d("small",es,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((z=o.error)==null?void 0:z.secondary_name[0]),1)])):_("",!0)]),s("div",ss,[s("small",os,[t(n,{name:"envelope",type:"solid",size:"12px",className:"me-2",color:"#969696"}),l(" Child Email "),ns]),v(s("input",{type:"email","onUpdate:modelValue":r[4]||(r[4]=a=>o.registration.secondary_email=a),class:"form-control"},null,512),[[y,o.registration.secondary_email]])]),s("div",ts,[s("small",ls,[t(n,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),l(" Child Number "),rs]),v(s("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=a=>o.registration.secondary_phone=a),class:"form-control"},null,512),[[y,o.registration.secondary_phone]])])])])):_("",!0),s("div",is,[s("small",as,[t(n,{name:"school",type:"solid",size:"12px",className:"me-2",color:"#969696"}),l(" School Name "),cs]),t(B,{data:o.registration.school_id,onCheck:o.checkComponent,onNew:o.newData},null,8,["data","onCheck","onNew"]),(S=o.error)!=null&&S.school_id?(c(),d("small",ds,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((j=o.error)==null?void 0:j.school_id[0]),1)])):_("",!0)]),o.registration.role=="parent"&&o.registration.have_child||o.registration.role=="student"?(c(),d("div",ms,[s("small",us,[t(n,{name:"flag-alt",type:"solid",size:"12px",className:"me-2",color:"#969696"}),l(" Dream University "),_s]),t(G,{data:o.registration.destination_country,onCheck:o.checkComponent},null,8,["data","onCheck"]),(V=o.error)!=null&&V.destination_country?(c(),d("small",hs,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),l(" "+p((D=o.error)==null?void 0:D.destination_country[0]),1)])):_("",!0)])):_("",!0)])])]),ps,s("div",vs,[s("button",{class:"btn btn-outline-warning py-1 px-2",onClick:r[6]||(r[6]=a=>o.scan=!0),disabled:o.loading},[t(U,{icon:"fa-arrow-left"}),l(" Back to Scan ")],8,ys),s("div",gs,[s("div",fs,[bs,v(s("input",{type:"number","onUpdate:modelValue":r[7]||(r[7]=a=>o.registration.attend_party=a),class:"form-control mb-0",style:{"font-weight":"bold"}},null,512),[[y,o.registration.attend_party]])]),s("button",{class:"btn btn-primary ms-2 h-100",onClick:r[8]||(r[8]=(...a)=>o.submit&&o.submit(...a)),disabled:o.loading},[t(U,{icon:o.loading?"fa-solid fa-spinner":"fa-solid fa-save",class:"me-2",pulse:o.loading},null,8,["icon","pulse"]),l(" "+p(o.loading?"Waiting":"Submit"),1)],8,ks)])])])])])])]))])])}const Ss=Z(re,[["render",ws]]);export{Ss as default};
