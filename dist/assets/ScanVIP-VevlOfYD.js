import{S as Q,G as X,C as Z,A as I,s as v}from"./GraduationYear-wfzZSCHf.js";import{_ as ee,h as se,k,l as c,m as d,s,q as t,B as oe,C as r,v as _,D as y,E as g,A as p,r as f,j as ne,J as M,I as te}from"./index-NPwr6cHB.js";import{C as le}from"./ClientEventService-ZeAPHePK.js";import{_ as re}from"./confirmation-Mz0TInWP.js";const ie=se({name:"event-scan",props:{url:String},components:{School:Q,GraduationYear:X,Country:Z},setup(o){const l=f(!0),D=f(),q=f(),w=f(!1),h=f(!1),E=f(),n=f({role:"student",fullname:"",mail:"",phone:"",secondary_name:"",secondary_email:"",secondary_phone:"",school_id:"",other_school:"",graduation_year:"",destination_country:[],scholarship:"N",lead_source_id:"",event_id:"",attend_status:"",attend_party:"",event_type:"",status:"PR",referral:"",client_type:"",have_child:!1}),G=async e=>{const u=M().start();if(h.value=!0,e){const i=e;try{const m=await I.get(i);m.success?b(m.data):v("error","Please try again!","bottom-start"),h.value=!1,u.finish()}catch(m){console.error(m),h.value=!1,u.finish()}}},Y=async e=>{const u=M().start();h.value=!0;const i=e;try{const m=await I.get(i);m.success?b(m.data):v("error","Please try again!","bottom-start"),h.value=!1,u.finish()}catch(m){v("error","Please try again!","bottom-start"),console.error(m),h.value=!1,u.finish()}},$=(e=null)=>{n.value[e.key]=e==null?void 0:e.value},U=e=>{n.value[e==null?void 0:e.key]=e==null?void 0:e.value},b=e=>{var u,i,m,N,C,z,x,j,V,P,S,a,R,T,L,F,J,O,W,H;if(((u=e==null?void 0:e.joined_event)==null?void 0:u.attend_status)==1)v("warning","You have already scanned.","bottom-start");else{l.value=!1;const A=e.role=="teacher/counsellor"?"teacher":e.role;q.value=e.is_vip,D.value=(i=e.joined_event)==null?void 0:i.clientevent_id,n.value.role=e.role,n.value.fullname=(m=e[A])==null?void 0:m.name,n.value.mail=(N=e[A])==null?void 0:N.mail,n.value.phone=(C=e[A])==null?void 0:C.phone,n.value.secondary_name=e.role=="parent"?(z=e.student)==null?void 0:z.name:null,n.value.secondary_email=e.role=="parent"?(x=e.student)==null?void 0:x.mail:null,n.value.secondary_phone=e.role=="parent"?(j=e.student)==null?void 0:j.phone:null,n.value.school_id=(V=e.education)==null?void 0:V.school_id,n.value.other_school=null,n.value.graduation_year=(P=e.education)!=null&&P.graduation_year?(S=e.education)==null?void 0:S.graduation_year:null,n.value.destination_country=[],e!=null&&e.dreams_countries&&(e==null||e.dreams_countries.forEach(K=>{n.value.destination_country.push(K.country_id)})),n.value.scholarship=e!=null&&e.scholarship?e==null?void 0:e.scholarship:"N",n.value.lead_source_id=(a=e==null?void 0:e.lead)==null?void 0:a.lead_id,n.value.event_id=(R=e==null?void 0:e.joined_event)==null?void 0:R.event_id,n.value.attend_status=((T=e==null?void 0:e.joined_event)==null?void 0:T.attend_status)==1?"attend":null,n.value.attend_party=(L=e==null?void 0:e.joined_event)==null?void 0:L.attend_party,n.value.event_type=(F=e==null?void 0:e.joined_event)==null?void 0:F.event_type,n.value.status=((J=e==null?void 0:e.joined_event)==null?void 0:J.status)=="ots"?"OTS":"PR",n.value.referral=(O=e==null?void 0:e.joined_event)==null?void 0:O.referral,n.value.client_type=(W=e==null?void 0:e.joined_event)==null?void 0:W.client_type,n.value.have_child=!!(e.role=="parent"&&((H=e.student)!=null&&H.name))}},B=async()=>{w.value=!0;const e=M().start(),u="v1/registration/verify/"+D.value;try{const i=await I.patch(u,n.value);i.success?(v("success",i.message,"bottom-start"),le.saveClientEvent(i),setTimeout(()=>{te.push({name:"thanks-event",params:{status:"ots",type:"onsite"}})},3e3)):(E.value=i.error?i.error:null,v("error",i.message?i.message:"Please complete the fields above!","bottom-start")),w.value=!1,e.finish()}catch(i){v("error","Please try again!","bottom-start"),w.value=!1,console.error(i),e.finish()}};return ne(()=>{o.url&&Y(o.url)}),{scan:l,event_id:D,is_vip:q,loading:w,qrloading:h,error:E,registration:n,onDecode:G,checkComponent:$,newData:U,checkingData:b,submit:B}}}),ae={id:"registration"},ce={class:"container-fluid"},de={key:0,class:"row",style:{height:"100dvh"}},me=s("div",{class:"col-md-8 bg-primary",style:{background:"url('/img/bg-scan.webp')","background-size":"cover","background-position":"center"}},null,-1),ue={class:"col-md-4"},_e={class:"d-flex align-items-center w-100 h-100 px-5"},he={class:"d-flex align-items-center w-100 h-100"},pe={class:"w-100 text-center"},ve=s("div",{class:"p-2 text-dark",style:{background:"#fed118"}},[s("h3",{class:"m-0"},[s("strong",null," VIP MEMBER ")])],-1),ye={class:"card shadow rounded-0 border-0 mb-3"},ge={class:"card-body p-1"},fe={key:0,class:"p-0"},be={key:1,class:"p-2"},ke={key:1,class:"row justify-content-center",style:{height:"100dvh"}},we={class:"col-md-8"},Ne={class:"d-flex align-items-center w-100 h-100"},Ce={class:"card shadow border-0 rounded-0 w-100"},ze={class:"d-flex justify-content-between align-items-center my-0"},xe={class:"m-0 d-flex"},je={class:"d-flex align-items-center"},Ve={key:0,class:"mb-0"},Pe={class:"card-body"},Se={class:"row align-items-center"},De=s("div",{class:"col-md-4 text-center"},[s("img",{src:re,alt:"EduALL Confirmation",class:"w-75"})],-1),Ee={class:"col-md-8"},Ue={class:"row g-3"},Be={class:"col-md-6"},qe={class:"text-muted label"},Ge=s("span",{class:"text-danger"},"*",-1),Ye={key:0,class:"text-danger error"},$e={class:"col-md-6"},Ae={class:"text-muted label"},Ie=s("span",{class:"text-danger"},"*",-1),Me={key:0,class:"text-danger error"},Re={class:"col-md-6"},Te={class:"text-muted label"},Le=s("span",{class:"text-danger"},"*",-1),Fe={key:0,class:"text-danger error"},Je={key:0,class:"col-md-6"},Oe={class:"text-muted label"},We=s("span",{class:"text-danger"},"*",-1),He={key:0,class:"text-danger error"},Ke={key:1,class:"col-md-12"},Qe={class:"row"},Xe={class:"col-md-4"},Ze={class:"text-muted label"},es=s("span",{class:"text-danger"},"*",-1),ss={key:0,class:"text-danger error"},os={class:"col-md-4"},ns={class:"text-muted label"},ts=s("span",{class:"text-danger"},null,-1),ls={class:"col-md-4"},rs={class:"text-muted label"},is=s("span",{class:"text-danger"},null,-1),as={class:"col-md-12"},cs={class:"text-muted label"},ds=s("span",{class:"text-danger"},"*",-1),ms={key:0,class:"text-danger error"},us={key:2,class:"col-md-12"},_s={class:"text-muted label"},hs=s("span",{class:"text-danger"},"*",-1),ps={key:0,class:"text-danger error"},vs=s("hr",null,null,-1),ys={class:"d-flex justify-content-between align-items-end mb-3"},gs=["disabled"],fs={class:"d-flex w-75 text-end align-items-end justify-content-end"},bs={style:{width:"100px"}},ks=s("small",{class:"text-muted label"},[r(" Party Number "),s("span",{class:"text-danger"},"*")],-1),ws=["disabled"];function Ns(o,l,D,q,w,h){var b,B,e,u,i,m,N,C,z,x,j,V,P,S;const E=k("qr-stream"),n=k("box-icon"),G=k("GraduationYear"),Y=k("School"),$=k("Country"),U=k("font-awesome-icon");return c(),d("div",ae,[s("div",ce,[o.scan?(c(),d("div",de,[me,s("div",ue,[s("div",_e,[s("div",he,[s("div",pe,[ve,s("div",ye,[s("div",ge,[o.qrloading?(c(),d("div",be,[t(n,{name:"loader-circle",animation:"spin"})])):(c(),d("div",fe,[t(E,{onDecode:o.onDecode,style:{width:"100%"},class:"rounded"},null,8,["onDecode"])]))])])])])])])])):(c(),d("div",ke,[s("div",we,[s("div",Ne,[s("div",Ce,[s("div",{class:oe(["card-header",o.is_vip?"bg-warning text-white":""])},[s("div",ze,[s("h4",xe,[t(n,{name:"user-circle",color:o.is_vip?"#fff":"#000",class:"mt-1 me-2"},null,8,["color"]),r(" Confirmation ")]),s("div",je,[o.is_vip?(c(),d("h2",Ve,"VIP")):_("",!0)])])],2),s("div",Pe,[s("div",Se,[De,s("div",Ee,[s("div",Ue,[s("div",Be,[s("small",qe,[t(n,{name:"user",size:"12px",className:"me-2",color:"#969696"}),r(" Full Name "),Ge]),y(s("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>o.registration.fullname=a),class:"form-control"},null,512),[[g,o.registration.fullname]]),(b=o.error)!=null&&b.fullname?(c(),d("small",Ye,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((B=o.error)==null?void 0:B.fullname[0]),1)])):_("",!0)]),s("div",$e,[s("small",Ae,[t(n,{name:"envelope",size:"12px",className:"me-2",color:"#969696"}),r(" Email "),Ie]),y(s("input",{type:"email","onUpdate:modelValue":l[1]||(l[1]=a=>o.registration.mail=a),class:"form-control"},null,512),[[g,o.registration.mail]]),(e=o.error)!=null&&e.mail?(c(),d("small",Me,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((u=o.error)==null?void 0:u.mail[0]),1)])):_("",!0)]),s("div",Re,[s("small",Te,[t(n,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),r(" Phone Number "),Le]),y(s("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=a=>o.registration.phone=a),class:"form-control"},null,512),[[g,o.registration.phone]]),(i=o.error)!=null&&i.phone?(c(),d("small",Fe,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((m=o.error)==null?void 0:m.phone[0]),1)])):_("",!0)]),o.registration.graduation_year?(c(),d("div",Je,[s("small",Oe,[t(n,{name:"graduation",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Graduation Year "),We]),t(G,{data:o.registration.graduation_year,onCheck:o.checkComponent},null,8,["data","onCheck"]),(N=o.error)!=null&&N.graduation_year?(c(),d("small",He,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((C=o.error)==null?void 0:C.graduation_year[0]),1)])):_("",!0)])):_("",!0),o.registration.have_child?(c(),d("div",Ke,[s("div",Qe,[s("div",Xe,[s("small",Ze,[t(n,{name:"user",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Child Name "),es]),y(s("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=a=>o.registration.secondary_name=a),class:"form-control"},null,512),[[g,o.registration.secondary_name]]),(z=o.error)!=null&&z.secondary_name?(c(),d("small",ss,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((x=o.error)==null?void 0:x.secondary_name[0]),1)])):_("",!0)]),s("div",os,[s("small",ns,[t(n,{name:"envelope",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Child Email "),ts]),y(s("input",{type:"email","onUpdate:modelValue":l[4]||(l[4]=a=>o.registration.secondary_email=a),class:"form-control"},null,512),[[g,o.registration.secondary_email]])]),s("div",ls,[s("small",rs,[t(n,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),r(" Child Number "),is]),y(s("input",{type:"text","onUpdate:modelValue":l[5]||(l[5]=a=>o.registration.secondary_phone=a),class:"form-control"},null,512),[[g,o.registration.secondary_phone]])])])])):_("",!0),s("div",as,[s("small",cs,[t(n,{name:"school",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" School Name "),ds]),t(Y,{data:o.registration.school_id,onCheck:o.checkComponent,onNew:o.newData},null,8,["data","onCheck","onNew"]),(j=o.error)!=null&&j.school_id?(c(),d("small",ms,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((V=o.error)==null?void 0:V.school_id[0]),1)])):_("",!0)]),o.registration.role=="parent"&&o.registration.have_child||o.registration.role=="student"?(c(),d("div",us,[s("small",_s,[t(n,{name:"flag-alt",type:"solid",size:"12px",className:"me-2",color:"#969696"}),r(" Dream University "),hs]),t($,{data:o.registration.destination_country,onCheck:o.checkComponent},null,8,["data","onCheck"]),(P=o.error)!=null&&P.destination_country?(c(),d("small",ps,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),r(" "+p((S=o.error)==null?void 0:S.destination_country[0]),1)])):_("",!0)])):_("",!0)])])]),vs,s("div",ys,[s("button",{class:"btn btn-outline-warning py-1 px-2",onClick:l[6]||(l[6]=a=>o.scan=!0),disabled:o.loading},[t(U,{icon:"fa-arrow-left"}),r(" Back to Scan ")],8,gs),s("div",fs,[s("div",bs,[ks,y(s("input",{type:"number","onUpdate:modelValue":l[7]||(l[7]=a=>o.registration.attend_party=a),class:"form-control mb-0",style:{"font-weight":"bold"}},null,512),[[g,o.registration.attend_party]])]),s("button",{class:"btn btn-primary ms-2 h-100",onClick:l[8]||(l[8]=(...a)=>o.submit&&o.submit(...a)),disabled:o.loading},[t(U,{icon:o.loading?"fa-solid fa-spinner":"fa-solid fa-save",class:"me-2",pulse:o.loading},null,8,["icon","pulse"]),r(" "+p(o.loading?"Waiting":"Submit"),1)],8,ws)])])])])])])]))])])}const Vs=ee(ie,[["render",Ns]]);export{Vs as default};
