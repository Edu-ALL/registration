import{S as K,G as Q,C as X,A as I,s as b}from"./GraduationYear-A9jomXLC.js";import{_ as Z,h as ee,k,l as c,m as d,s,q as t,B as se,C as i,v as _,D as v,E as g,A as p,r as y,j as oe,J as M,I as ne}from"./index-DJMSZmr4.js";import{C as te}from"./ClientEventService-ZeAPHePK.js";import{_ as le}from"./confirmation-Mz0TInWP.js";const re=ee({name:"event-scan",props:{url:String},components:{School:K,GraduationYear:Q,Country:X},setup(o){const l=y(!0),D=y(),q=y(),w=y(!1),h=y(!1),E=y(),n=y({role:"student",fullname:"",mail:"",phone:"",secondary_name:"",secondary_email:"",secondary_phone:"",school_id:"",other_school:"",graduation_year:"",destination_country:[],scholarship:"N",lead_source_id:"",event_id:"",attend_status:"",attend_party:"",event_type:"",status:"PR",referral:"",client_type:"",have_child:!1}),G=async e=>{console.log(e);const u=M().start();if(h.value=!0,e){const r=e;try{const m=await I.get(r);m.success?f(m.data):b("error","Please try again!","bottom-start"),h.value=!1,u.finish()}catch(m){console.error(m),h.value=!1,u.finish()}}},$=async e=>{const u=M().start();h.value=!0;const r=e;console.log(r);try{const m=await I.get(r);m.success?f(m.data):b("error","Please try again!","bottom-start"),h.value=!1,u.finish()}catch(m){b("error","Please try again!","bottom-start"),console.error(m),h.value=!1,u.finish()}},A=(e=null)=>{n.value[e.key]=e==null?void 0:e.value,console.log(n.value)},U=e=>{n.value[e==null?void 0:e.key]=e==null?void 0:e.value},f=e=>{var r,m,N,C,z,x,V,j,P,S,a,R,T,Y,L,F,J,O,W;l.value=!1;const u=e.role=="teacher/counsellor"?"teacher":e.role;q.value=e.is_vip,D.value=(r=e.joined_event)==null?void 0:r.clientevent_id,n.value.role=e.role,n.value.fullname=(m=e[u])==null?void 0:m.name,n.value.mail=(N=e[u])==null?void 0:N.mail,n.value.phone=(C=e[u])==null?void 0:C.phone,n.value.secondary_name=e.role=="parent"?(z=e.student)==null?void 0:z.name:null,n.value.secondary_email=e.role=="parent"?(x=e.student)==null?void 0:x.mail:null,n.value.secondary_phone=e.role=="parent"?(V=e.student)==null?void 0:V.phone:null,n.value.school_id=(j=e.education)==null?void 0:j.school_id,n.value.other_school=null,n.value.graduation_year=(P=e.education)!=null&&P.graduation_year?(S=e.education)==null?void 0:S.graduation_year:null,n.value.destination_country=[],e!=null&&e.dreams_countries&&(e==null||e.dreams_countries.forEach(H=>{n.value.destination_country.push(H.country_id)})),n.value.scholarship=e!=null&&e.scholarship?e==null?void 0:e.scholarship:"N",n.value.lead_source_id=(a=e==null?void 0:e.lead)==null?void 0:a.lead_id,n.value.event_id=(R=e==null?void 0:e.joined_event)==null?void 0:R.event_id,n.value.attend_status=((T=e==null?void 0:e.joined_event)==null?void 0:T.attend_status)==1?"attend":null,n.value.attend_party=(Y=e==null?void 0:e.joined_event)==null?void 0:Y.attend_party,n.value.event_type=(L=e==null?void 0:e.joined_event)==null?void 0:L.event_type,n.value.status=((F=e==null?void 0:e.joined_event)==null?void 0:F.status)=="ots"?"OTS":"PR",n.value.referral=(J=e==null?void 0:e.joined_event)==null?void 0:J.referral,n.value.client_type=(O=e==null?void 0:e.joined_event)==null?void 0:O.client_type,n.value.have_child=!!(e.role=="parent"&&((W=e.student)!=null&&W.name))},B=async()=>{w.value=!0;const e=M().start(),u="v1/registration/verify/"+D.value;try{const r=await I.patch(u,n.value);r.success?(b("success",r.message,"bottom-start"),te.saveClientEvent(r),setTimeout(()=>{ne.push({name:"thanks-event",params:{status:"ots",type:"onsite"}})},3e3)):(E.value=r.error?r.error:null,b("error",r.message?r.message:"Please complete the fields above!","bottom-start")),w.value=!1,e.finish()}catch(r){b("error","Please try again!","bottom-start"),w.value=!1,console.error(r),e.finish()}};return oe(()=>{o.url&&$(o.url)}),{scan:l,event_id:D,is_vip:q,loading:w,qrloading:h,error:E,registration:n,onDecode:G,checkComponent:A,newData:U,checkingData:f,submit:B}}}),ie={id:"registration"},ae={class:"container-fluid"},ce={key:0,class:"row",style:{height:"100dvh"}},de=s("div",{class:"col-md-8 bg-primary",style:{background:"url('/img/bg-scan.webp')","background-size":"cover","background-position":"center"}},null,-1),me={class:"col-md-4"},ue={class:"d-flex align-items-center w-100 h-100 px-5"},_e={class:"d-flex align-items-center w-100 h-100"},he={class:"w-100 text-center"},pe=s("div",{class:"p-2 text-dark",style:{background:"#FED118"}},[s("h3",{class:"m-0"},[s("strong",null," VIP MEMBER ")])],-1),ve={class:"card shadow rounded-0 border-0 mb-3"},ge={class:"card-body p-1"},ye={key:0,class:"p-0"},fe={key:1,class:"p-2"},be={key:1,class:"row justify-content-center",style:{height:"100dvh"}},ke={class:"col-md-8"},we={class:"d-flex align-items-center w-100 h-100"},Ne={class:"card shadow border-0 rounded-0 w-100"},Ce={class:"d-flex justify-content-between align-items-center my-0"},ze={class:"m-0 d-flex"},xe={class:"d-flex align-items-center"},Ve={key:0,class:"mb-0"},je={class:"card-body"},Pe={class:"row align-items-center"},Se=s("div",{class:"col-md-4 text-center"},[s("img",{src:le,alt:"EduALL Confirmation",class:"w-75"})],-1),De={class:"col-md-8"},Ee={class:"row g-3"},Ue={class:"col-md-6"},Be={class:"text-muted label"},qe=s("span",{class:"text-danger"},"*",-1),Ge={key:0,class:"text-danger error"},$e={class:"col-md-6"},Ae={class:"text-muted label"},Ie=s("span",{class:"text-danger"},"*",-1),Me={key:0,class:"text-danger error"},Re={class:"col-md-6"},Te={class:"text-muted label"},Ye=s("span",{class:"text-danger"},"*",-1),Le={key:0,class:"text-danger error"},Fe={key:0,class:"col-md-6"},Je={class:"text-muted label"},Oe=s("span",{class:"text-danger"},"*",-1),We={key:0,class:"text-danger error"},He={key:1,class:"col-md-12"},Ke={class:"row"},Qe={class:"col-md-4"},Xe={class:"text-muted label"},Ze=s("span",{class:"text-danger"},"*",-1),es={key:0,class:"text-danger error"},ss={class:"col-md-4"},os={class:"text-muted label"},ns=s("span",{class:"text-danger"},null,-1),ts={class:"col-md-4"},ls={class:"text-muted label"},rs=s("span",{class:"text-danger"},null,-1),is={class:"col-md-12"},as={class:"text-muted label"},cs=s("span",{class:"text-danger"},"*",-1),ds={key:0,class:"text-danger error"},ms={key:2,class:"col-md-12"},us={class:"text-muted label"},_s=s("span",{class:"text-danger"},"*",-1),hs={key:0,class:"text-danger error"},ps=s("hr",null,null,-1),vs={class:"d-flex justify-content-between align-items-end mb-3"},gs=["disabled"],ys={class:"d-flex w-75 text-end align-items-end justify-content-end"},fs={style:{width:"100px"}},bs=s("small",{class:"text-muted label"},[i(" Party Number "),s("span",{class:"text-danger"},"*")],-1),ks=["disabled"];function ws(o,l,D,q,w,h){var f,B,e,u,r,m,N,C,z,x,V,j,P,S;const E=k("qr-stream"),n=k("box-icon"),G=k("GraduationYear"),$=k("School"),A=k("Country"),U=k("font-awesome-icon");return c(),d("div",ie,[s("div",ae,[o.scan?(c(),d("div",ce,[de,s("div",me,[s("div",ue,[s("div",_e,[s("div",he,[pe,s("div",ve,[s("div",ge,[o.qrloading?(c(),d("div",fe,[t(n,{name:"loader-circle",animation:"spin"})])):(c(),d("div",ye,[t(E,{onDecode:o.onDecode,style:{width:"100%"},class:"rounded"},null,8,["onDecode"])]))])])])])])])])):(c(),d("div",be,[s("div",ke,[s("div",we,[s("div",Ne,[s("div",{class:se(["card-header",o.is_vip?"bg-warning text-white":""])},[s("div",Ce,[s("h4",ze,[t(n,{name:"user-circle",color:o.is_vip?"#fff":"#000",class:"mt-1 me-2"},null,8,["color"]),i(" Confirmation ")]),s("div",xe,[o.is_vip?(c(),d("h2",Ve,"VIP")):_("",!0)])])],2),s("div",je,[s("div",Pe,[Se,s("div",De,[s("div",Ee,[s("div",Ue,[s("small",Be,[t(n,{name:"user",size:"12px",className:"me-2",color:"#969696"}),i(" Full Name "),qe]),v(s("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>o.registration.fullname=a),class:"form-control"},null,512),[[g,o.registration.fullname]]),(f=o.error)!=null&&f.fullname?(c(),d("small",Ge,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((B=o.error)==null?void 0:B.fullname[0]),1)])):_("",!0)]),s("div",$e,[s("small",Ae,[t(n,{name:"envelope",size:"12px",className:"me-2",color:"#969696"}),i(" Email "),Ie]),v(s("input",{type:"email","onUpdate:modelValue":l[1]||(l[1]=a=>o.registration.mail=a),class:"form-control"},null,512),[[g,o.registration.mail]]),(e=o.error)!=null&&e.mail?(c(),d("small",Me,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((u=o.error)==null?void 0:u.mail[0]),1)])):_("",!0)]),s("div",Re,[s("small",Te,[t(n,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),i(" Phone Number "),Ye]),v(s("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=a=>o.registration.phone=a),class:"form-control"},null,512),[[g,o.registration.phone]]),(r=o.error)!=null&&r.phone?(c(),d("small",Le,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((m=o.error)==null?void 0:m.phone[0]),1)])):_("",!0)]),o.registration.graduation_year?(c(),d("div",Fe,[s("small",Je,[t(n,{name:"graduation",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Graduation Year "),Oe]),t(G,{data:o.registration.graduation_year,onCheck:o.checkComponent},null,8,["data","onCheck"]),(N=o.error)!=null&&N.graduation_year?(c(),d("small",We,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((C=o.error)==null?void 0:C.graduation_year[0]),1)])):_("",!0)])):_("",!0),o.registration.have_child?(c(),d("div",He,[s("div",Ke,[s("div",Qe,[s("small",Xe,[t(n,{name:"user",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Child Name "),Ze]),v(s("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=a=>o.registration.secondary_name=a),class:"form-control"},null,512),[[g,o.registration.secondary_name]]),(z=o.error)!=null&&z.secondary_name?(c(),d("small",es,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((x=o.error)==null?void 0:x.secondary_name[0]),1)])):_("",!0)]),s("div",ss,[s("small",os,[t(n,{name:"envelope",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Child Email "),ns]),v(s("input",{type:"email","onUpdate:modelValue":l[4]||(l[4]=a=>o.registration.secondary_email=a),class:"form-control"},null,512),[[g,o.registration.secondary_email]])]),s("div",ts,[s("small",ls,[t(n,{name:"mobile",size:"12px",className:"me-2",color:"#969696"}),i(" Child Number "),rs]),v(s("input",{type:"text","onUpdate:modelValue":l[5]||(l[5]=a=>o.registration.secondary_phone=a),class:"form-control"},null,512),[[g,o.registration.secondary_phone]])])])])):_("",!0),s("div",is,[s("small",as,[t(n,{name:"school",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" School Name "),cs]),t($,{data:o.registration.school_id,onCheck:o.checkComponent,onNew:o.newData},null,8,["data","onCheck","onNew"]),(V=o.error)!=null&&V.school_id?(c(),d("small",ds,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((j=o.error)==null?void 0:j.school_id[0]),1)])):_("",!0)]),o.registration.role=="parent"&&o.registration.have_child||o.registration.role=="student"?(c(),d("div",ms,[s("small",us,[t(n,{name:"flag-alt",type:"solid",size:"12px",className:"me-2",color:"#969696"}),i(" Dream University "),_s]),t(A,{data:o.registration.destination_country,onCheck:o.checkComponent},null,8,["data","onCheck"]),(P=o.error)!=null&&P.destination_country?(c(),d("small",hs,[t(n,{name:"info-circle",animation:"tada",size:"12px",color:"#d21414",className:"me-1"}),i(" "+p((S=o.error)==null?void 0:S.destination_country[0]),1)])):_("",!0)])):_("",!0)])])]),ps,s("div",vs,[s("button",{class:"btn btn-outline-warning py-1 px-2",onClick:l[6]||(l[6]=a=>o.scan=!0),disabled:o.loading},[t(U,{icon:"fa-arrow-left"}),i(" Back to Scan ")],8,gs),s("div",ys,[s("div",fs,[bs,v(s("input",{type:"number","onUpdate:modelValue":l[7]||(l[7]=a=>o.registration.attend_party=a),class:"form-control mb-0",style:{"font-weight":"bold"}},null,512),[[g,o.registration.attend_party]])]),s("button",{class:"btn btn-primary ms-2 h-100",onClick:l[8]||(l[8]=(...a)=>o.submit&&o.submit(...a)),disabled:o.loading},[t(U,{icon:o.loading?"fa-solid fa-spinner":"fa-solid fa-save",class:"me-2",pulse:o.loading},null,8,["icon","pulse"]),i(" "+p(o.loading?"Waiting":"Submit"),1)],8,ks)])])])])])])]))])])}const Vs=Z(re,[["render",ws]]);export{Vs as default};
